<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Game ƒêo√°n S·ªë - 3 Ch·∫ø ƒê·ªô</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ===== RESET & VARIABLES ===== */
    :root {
      --primary: #4361ee;
      --primary-dark: #3a56d4;
      --secondary: #7209b7;
      --success: #06d6a0;
      --warning: #ffd166;
      --danger: #ef476f;
      --dark: #2b2d42;
      --light: #f8f9fa;
      --gray: #adb5bd;
      --white: #ffffff;
      
      --radius: 16px;
      --shadow: 0 10px 30px rgba(0,0,0,0.1);
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      color: var(--dark);
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: var(--white);
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
      animation: fadeIn 0.8s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* ===== HEADER ===== */
    .header {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      padding: 30px;
      text-align: center;
    }
    
    .header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      font-weight: 700;
    }
    
    .header p {
      opacity: 0.9;
      font-size: 1.1rem;
    }
    
    .stats {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-top: 25px;
      flex-wrap: wrap;
    }
    
    .stat-box {
      background: rgba(255,255,255,0.15);
      padding: 20px 30px;
      border-radius: 12px;
      min-width: 180px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
    }
    
    .stat-label {
      display: block;
      font-size: 0.9rem;
      opacity: 0.9;
      margin-bottom: 5px;
    }
    
    .stat-value {
      display: block;
      font-size: 2rem;
      font-weight: 700;
    }
    
    /* ===== MODE SELECTION ===== */
    .mode-section {
      padding: 30px;
      background: var(--light);
      border-bottom: 2px solid #eee;
    }
    
    .mode-section h2 {
      text-align: center;
      margin-bottom: 25px;
      color: var(--dark);
      font-size: 1.8rem;
    }
    
    .mode-buttons {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .mode-btn {
      flex: 1;
      min-width: 250px;
      padding: 25px;
      border: none;
      border-radius: var(--radius);
      background: white;
      font-family: 'Poppins', sans-serif;
      font-size: 1.2rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      box-shadow: var(--shadow);
    }
    
    .mode-btn i {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }
    
    .mode-btn.active {
      color: white;
      transform: translateY(-5px);
    }
    
    .mode-btn.easy.active { background: linear-gradient(135deg, #06d6a0, #04b487); }
    .mode-btn.normal.active { background: linear-gradient(135deg, #ffd166, #ffb142); }
    .mode-btn.hard.active { background: linear-gradient(135deg, #ef476f, #d8345f); }
    
    /* ===== GAME AREA ===== */
    .game-area {
      padding: 30px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
    }
    
    @media (max-width: 900px) {
      .game-area { grid-template-columns: 1fr; }
    }
    
    /* ===== GAME INFO ===== */
    .game-info {
      background: linear-gradient(135deg, #f8f9fa, #e9ecef);
      padding: 25px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    
    .game-info h3 {
      margin-bottom: 20px;
      color: var(--dark);
      font-size: 1.4rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }
    
    .info-item {
      background: white;
      padding: 15px;
      border-radius: 12px;
      text-align: center;
    }
    
    .info-label {
      display: block;
      font-size: 0.9rem;
      color: var(--gray);
      margin-bottom: 5px;
    }
    
    .info-value {
      display: block;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--dark);
    }
    
    /* ===== GUESS INPUTS ===== */
    .guess-section {
      text-align: center;
    }
    
    .guess-inputs {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 30px 0;
      flex-wrap: wrap;
    }
    
    .number-input {
      width: 65px;
      height: 65px;
      border-radius: 12px;
      border: 3px solid #e0e0e0;
      text-align: center;
      font-size: 2rem;
      font-weight: 700;
      font-family: 'Poppins', sans-serif;
      background: white;
      color: var(--dark);
      transition: var(--transition);
    }
    
    .number-input:focus {
      border-color: var(--primary);
      outline: none;
      transform: scale(1.05);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }
    
    .legend {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
      flex-wrap: wrap;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
    }
    
    .legend-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
    }
    
    .legend-dot.correct { background: var(--success); }
    .legend-dot.partial { background: var(--warning); }
    .legend-dot.wrong { background: var(--danger); }
    
    /* ===== BUTTONS ===== */
    .buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin: 25px 0;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 15px 30px;
      border: none;
      border-radius: var(--radius);
      font-family: 'Poppins', sans-serif;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 10px;
      min-width: 180px;
      justify-content: center;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
    }
    
    .btn-secondary {
      background: var(--warning);
      color: #333;
    }
    
    .btn-outline {
      background: transparent;
      border: 2px solid var(--gray);
      color: var(--gray);
    }
    
    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    }
    
    .btn:active {
      transform: translateY(-1px);
    }
    
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }
    
    /* ===== ERROR MESSAGE ===== */
    .error-message {
      text-align: center;
      color: var(--danger);
      font-weight: 600;
      padding: 12px;
      background: rgba(239, 71, 111, 0.1);
      border-radius: 8px;
      margin: 15px 0;
      min-height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    /* ===== HISTORY ===== */
    .history-section {
      grid-column: 1 / -1;
      margin-top: 30px;
    }
    
    .history-section h3 {
      margin-bottom: 20px;
      font-size: 1.5rem;
      color: var(--dark);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .history-list {
      background: var(--light);
      border-radius: var(--radius);
      padding: 20px;
      max-height: 300px;
      overflow-y: auto;
    }
    
    .history-item {
      background: white;
      padding: 15px 20px;
      border-radius: 12px;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 5px 15px rgba(0,0,0,0.05);
      animation: slideIn 0.3s ease;
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    .guess-numbers {
      display: flex;
      gap: 10px;
      font-size: 1.4rem;
      font-weight: 600;
    }
    
    .guess-feedback {
      display: flex;
      gap: 10px;
    }
    
    .feedback-icon {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.8rem;
    }
    
    .feedback-icon.correct { background: var(--success); }
    .feedback-icon.partial { background: var(--warning); color: #333; }
    .feedback-icon.wrong { background: var(--danger); }
    
    /* ===== GAME RESULT ===== */
    .game-result {
      text-align: center;
      padding: 30px;
      border-radius: var(--radius);
      margin: 20px 0;
      font-size: 1.3rem;
      font-weight: 600;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }
    
    .game-result.win {
      background: linear-gradient(135deg, rgba(6, 214, 160, 0.1), rgba(4, 180, 135, 0.2));
      color: var(--success);
      border: 2px solid var(--success);
    }
    
    .game-result.lose {
      background: linear-gradient(135deg, rgba(239, 71, 111, 0.1), rgba(216, 52, 95, 0.2));
      color: var(--danger);
      border: 2px solid var(--danger);
    }
    
    /* ===== LEADERBOARD ===== */
    .leaderboard-section {
      grid-column: 1 / -1;
      margin-top: 40px;
      background: var(--light);
      padding: 25px;
      border-radius: var(--radius);
    }
    
    .leaderboard-section h3 {
      margin-bottom: 20px;
      font-size: 1.5rem;
      color: var(--dark);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .leaderboard-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .tab-btn {
      padding: 10px 20px;
      background: white;
      border: none;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .tab-btn.active {
      background: var(--primary);
      color: white;
    }
    
    .leaderboard-list {
      min-height: 200px;
      background: white;
      border-radius: 12px;
      padding: 20px;
    }
    
    .empty-leaderboard {
      text-align: center;
      padding: 40px 20px;
      color: var(--gray);
    }
    
    .empty-leaderboard i {
      font-size: 3rem;
      margin-bottom: 15px;
      color: #e0e0e0;
    }
    
    .leaderboard-item {
      display: flex;
      align-items: center;
      padding: 15px;
      border-bottom: 1px solid #eee;
    }
    
    .leaderboard-rank {
      width: 35px;
      height: 35px;
      background: var(--primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
      margin-right: 15px;
    }
    
    .leaderboard-rank.gold { background: linear-gradient(135deg, #ffd700, #ffb142); }
    .leaderboard-rank.silver { background: linear-gradient(135deg, #c0c0c0, #a0a0a0); }
    .leaderboard-rank.bronze { background: linear-gradient(135deg, #cd7f32, #a6692e); }
    
    .leaderboard-info {
      flex: 1;
    }
    
    .leaderboard-name {
      font-weight: 600;
    }
    
    .leaderboard-details {
      font-size: 0.85rem;
      color: var(--gray);
      margin-top: 3px;
    }
    
    .leaderboard-score {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--dark);
    }
    
    /* ===== INSTRUCTIONS ===== */
    .instructions {
      margin-top: 40px;
      padding: 25px;
      background: linear-gradient(135deg, #fdfcfb, #f5f0eb);
      border-radius: var(--radius);
      border: 2px dashed var(--warning);
    }
    
    .instructions h3 {
      margin-bottom: 20px;
      font-size: 1.5rem;
      color: var(--dark);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .instruction-steps {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }
    
    .step {
      background: white;
      padding: 20px;
      border-radius: 12px;
      position: relative;
      box-shadow: var(--shadow);
    }
    
    .step-number {
      position: absolute;
      top: -12px;
      left: -12px;
      width: 35px;
      height: 35px;
      background: var(--primary);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
    }
    
    /* ===== FOOTER ===== */
    .footer {
      margin-top: 30px;
      padding: 20px;
      text-align: center;
      color: var(--gray);
      border-top: 1px solid #eee;
    }
    
    .footer i {
      color: var(--danger);
      animation: heartbeat 1.5s infinite;
    }
    
    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    /* ===== RESPONSIVE ===== */
    @media (max-width: 768px) {
      .header h1 { font-size: 2rem; }
      .stat-box { min-width: 140px; padding: 15px 20px; }
      .stat-value { font-size: 1.6rem; }
      .mode-btn { min-width: 100%; }
      .number-input { width: 50px; height: 50px; font-size: 1.6rem; }
      .btn { min-width: 100%; }
      .game-area { padding: 20px; }
    }
    
    @media (max-width: 480px) {
      body { padding: 10px; }
      .container { border-radius: 20px; }
      .header { padding: 20px; }
      .stats { gap: 15px; }
      .mode-buttons { gap: 15px; }
      .guess-inputs { gap: 10px; }
      .buttons { flex-direction: column; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <h1><i class="fas fa-brain"></i> Number Guesser</h1>
      <p>Challenge your logical thinking with 3 difficulty levels</p>
      
      <div class="stats">
        <div class="stat-box">
          <span class="stat-label">HIGH SCORE</span>
          <span id="highScore" class="stat-value">0</span>
        </div>
        <div class="stat-box">
          <span class="stat-label">SCORE</span>
          <span id="score" class="stat-value">0</span>
        </div>
        <div class="stat-box">
          <span class="stat-label">LEVEL</span>
          <span id="level" class="stat-value">Easy</span>
        </div>
      </div>
    </header>

    <!-- Mode Selection -->
    <section class="mode-section">
      <h2><i class="fas fa-gamepad"></i> Choose Your Challenge</h2>
      <div class="mode-buttons">
        <button class="mode-btn easy active" data-mode="easy">
          <i class="fas fa-seedling"></i>
          <span>BEGINNER</span>
          <small>5 numbers ‚Ä¢ 10 attempts</small>
        </button>
        
        <button class="mode-btn normal" data-mode="normal">
          <i class="fas fa-user"></i>
          <span>ADVANCED</span>
          <small>6 numbers ‚Ä¢ 12 attempts</small>
        </button>
        
        <button class="mode-btn hard" data-mode="hard">
          <i class="fas fa-fire"></i>
          <span>EXPERT</span>
          <small>7 numbers ‚Ä¢ 15 attempts</small>
        </button>
      </div>
    </section>

    <!-- Main Game Area -->
    <main class="game-area">
      <!-- Game Info -->
      <div class="game-info">
        <h3><i class="fas fa-chart-line"></i> Game Stats</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label">Numbers</span>
            <span id="currentLength" class="info-value">5</span>
          </div>
          <div class="info-item">
            <span class="info-label">Attempts</span>
            <span id="attemptInfo" class="info-value">0/10</span>
          </div>
          <div class="info-item">
            <span class="info-label">Time</span>
            <span id="timer" class="info-value">00:00</span>
          </div>
          <div class="info-item">
            <span class="info-label">Points</span>
            <span id="currentScore" class="info-value">0</span>
          </div>
        </div>
      </div>

      <!-- Guess Section -->
      <div class="guess-section">
        <div class="legend">
          <div class="legend-item">
            <span class="legend-dot correct"></span>
            <span>Correct digit & position</span>
          </div>
          <div class="legend-item">
            <span class="legend-dot partial"></span>
            <span>Correct digit, wrong position</span>
          </div>
          <div class="legend-item">
            <span class="legend-dot wrong"></span>
            <span>Wrong digit</span>
          </div>
        </div>

        <form id="guessForm" autocomplete="off">
          <div class="guess-inputs" id="inputs"></div>
          
          <div id="error" class="error-message"></div>
          
          <div class="buttons">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-paper-plane"></i>
              Submit Guess
            </button>
            <button type="button" id="hintBtn" class="btn btn-secondary">
              <i class="fas fa-lightbulb"></i>
              Hint <span id="hintCount">(3)</span>
            </button>
            <button type="button" id="restartBtn" class="btn btn-outline">
              <i class="fas fa-redo"></i>
              Restart
            </button>
          </div>
        </form>
      </div>

      <!-- Game Result -->
      <div id="endMessage" class="game-result" style="display: none;"></div>
      
      <div id="playAgain" class="buttons" style="display: none;">
        <button id="playAgainBtn" class="btn btn-primary">
          <i class="fas fa-play-circle"></i>
          Play Again
        </button>
      </div>

      <!-- History -->
      <section class="history-section">
        <h3><i class="fas fa-history"></i> Guess History</h3>
        <div id="history" class="history-list"></div>
      </section>

      <!-- Leaderboard -->
      <section class="leaderboard-section">
        <h3><i class="fas fa-trophy"></i> Leaderboard</h3>
        <div class="leaderboard-tabs">
          <button class="tab-btn active" data-tab="easy">Easy</button>
          <button class="tab-btn" data-tab="normal">Medium</button>
          <button class="tab-btn" data-tab="hard">Hard</button>
        </div>
        <div id="leaderboard" class="leaderboard-list">
          <div class="empty-leaderboard">
            <i class="fas fa-chart-line"></i>
            <p>No leaderboard records yet</p>
            <small>Win a game to appear here!</small>
          </div>
        </div>
      </section>

      <!-- Instructions -->
      <section class="instructions">
        <h3><i class="fas fa-graduation-cap"></i> How to Play</h3>
        <div class="instruction-steps">
          <div class="step">
            <div class="step-number">1</div>
            <p><strong>Guess</strong> the secret number with unique digits</p>
          </div>
          <div class="step">
            <div class="step-number">2</div>
            <p>First digit <strong>cannot be 0</strong></p>
          </div>
          <div class="step">
            <div class="step-number">3</div>
            <p>Use feedback to <strong>deduce</strong> the correct number</p>
          </div>
          <div class="step">
            <div class="step-number">4</div>
            <p>Win by guessing correctly before <strong>attempts run out</strong></p>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <p>Made with <i class="fas fa-heart"></i> by Number Guesser ‚Ä¢ Challenge your mind!</p>
    </footer>
  </div>

  <script>
    // ===== GAME LOGIC =====
    class NumberGuessingGame {
      constructor() {
        this.config = {
          easy: { length: 5, maxAttempts: 10, multiplier: 1 },
          normal: { length: 6, maxAttempts: 12, multiplier: 2 },
          hard: { length: 7, maxAttempts: 15, multiplier: 3 }
        };
        
        this.currentMode = 'easy';
        this.secretNumber = [];
        this.attempts = 0;
        this.history = [];
        this.score = 0;
        this.highScore = this.loadHighScore();
        this.hintsLeft = 3;
        this.startTime = null;
        this.timerInterval = null;
        this.gameActive = false;
        
        this.init();
      }
      
      init() {
        this.setupEventListeners();
        this.updateLeaderboard();
        this.updateStats();
        this.startNewGame();
      }
      
      setupEventListeners() {
        // Mode selection
        document.querySelectorAll('.mode-btn').forEach(btn => {
          btn.addEventListener('click', (e) => this.changeMode(e.currentTarget));
        });
        
        // Form submission
        document.getElementById('guessForm').addEventListener('submit', (e) => {
          e.preventDefault();
          this.handleGuess();
        });
        
        // Buttons
        document.getElementById('hintBtn').addEventListener('click', () => this.giveHint());
        document.getElementById('restartBtn').addEventListener('click', () => this.startNewGame());
        document.getElementById('playAgainBtn').addEventListener('click', () => this.startNewGame());
        
        // Leaderboard tabs
        document.querySelectorAll('.tab-btn').forEach(btn => {
          btn.addEventListener('click', (e) => this.changeLeaderboardTab(e.target));
        });
        
        // Auto-focus on input
        document.addEventListener('input', (e) => {
          if (e.target.classList.contains('number-input')) {
            this.handleInputNavigation(e.target);
          }
        });
      }
      
      changeMode(modeButton) {
        // Update active mode visually
        document.querySelectorAll('.mode-btn').forEach(btn => {
          btn.classList.remove('active');
        });
        modeButton.classList.add('active');
        
        // Update current mode
        this.currentMode = modeButton.dataset.mode;
        
        // Update level display
        const levelText = this.currentMode === 'easy' ? 'Easy' : 
                         this.currentMode === 'normal' ? 'Medium' : 'Hard';
        document.getElementById('level').textContent = levelText;
        
        // Start new game with selected mode
        this.startNewGame();
      }
      
      startNewGame() {
        this.gameActive = true;
        this.attempts = 0;
        this.history = [];
        this.hintsLeft = 3;
        this.secretNumber = this.generateSecretNumber();
        
        // Clear UI
        document.getElementById('history').innerHTML = '';
        document.getElementById('endMessage').innerHTML = '';
        document.getElementById('endMessage').style.display = 'none';
        document.getElementById('playAgain').style.display = 'none';
        document.getElementById('error').textContent = '';
        document.getElementById('guessForm').style.display = 'block';
        
        // Update UI
        this.updateInputs();
        this.updateAttemptInfo();
        this.updateHintButton();
        this.updateStats();
        
        // Start timer
        this.startTimer();
        
        // Focus first input
        setTimeout(() => {
          const firstInput = document.querySelector('.number-input');
          if (firstInput) firstInput.focus();
        }, 100);
      }
      
      generateSecretNumber() {
        const length = this.config[this.currentMode].length;
        let digits = [1, 2, 3, 4, 5, 6, 7, 8, 9];
        
        // First digit cannot be 0
        const first = digits[Math.floor(Math.random() * digits.length)];
        const secret = [first];
        
        // Remaining digits can include 0
        digits = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9].filter(d => d !== first);
        
        while (secret.length < length) {
          const idx = Math.floor(Math.random() * digits.length);
          const digit = digits.splice(idx, 1)[0];
          secret.push(digit);
        }
        
        return secret;
      }
      
      updateInputs() {
        const length = this.config[this.currentMode].length;
        const inputsContainer = document.getElementById('inputs');
        
        let html = '';
        for (let i = 0; i < length; i++) {
          html += `
            <input type="number" 
                   min="0" 
                   max="9" 
                   maxlength="1" 
                   class="number-input" 
                   required
                   data-index="${i}"
                   autocomplete="off">
          `;
        }
        
        inputsContainer.innerHTML = html;
        document.getElementById('currentLength').textContent = length;
      }
      
      handleInputNavigation(input) {
        const index = parseInt(input.dataset.index);
        const inputs = Array.from(document.querySelectorAll('.number-input'));
        
        if (input.value.length === 1 && index < inputs.length - 1) {
          inputs[index + 1].focus();
        }
      }
      
      updateAttemptInfo() {
        const maxAttempts = this.config[this.currentMode].maxAttempts;
        document.getElementById('attemptInfo').textContent = 
          `${this.attempts}/${maxAttempts}`;
      }
      
      updateHintButton() {
        const hintCount = document.getElementById('hintCount');
        hintCount.textContent = `(${this.hintsLeft})`;
        document.getElementById('hintBtn').disabled = this.hintsLeft === 0;
      }
      
      updateStats() {
        document.getElementById('score').textContent = this.score;
        document.getElementById('highScore').textContent = this.highScore;
        document.getElementById('currentScore').textContent = this.calculateCurrentGameScore();
      }
      
      startTimer() {
        this.stopTimer();
        this.startTime = Date.now();
        
        this.timerInterval = setInterval(() => {
          const elapsed = Date.now() - this.startTime;
          const minutes = Math.floor(elapsed / 60000);
          const seconds = Math.floor((elapsed % 60000) / 1000);
          document.getElementById('timer').textContent = 
            `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }, 1000);
      }
      
      stopTimer() {
        if (this.timerInterval) {
          clearInterval(this.timerInterval);
          this.timerInterval = null;
        }
      }
      
      handleGuess() {
        if (!this.gameActive) return;
        
        const inputs = Array.from(document.querySelectorAll('.number-input'));
        const guess = inputs.map(inp => Number(inp.value));
        
        // Validate guess
        const validation = this.validateGuess(guess);
        if (!validation.valid) {
          document.getElementById('error').textContent = validation.message;
          return;
        }
        
        // Clear error
        document.getElementById('error').textContent = '';
        
        // Check guess
        const result = this.checkGuess(guess);
        this.attempts++;
        this.history.push({ guess: [...guess], result: [...result] });
        
        // Update UI
        this.displayHistory();
        this.updateAttemptInfo();
        this.updateStats();
        
        // Check game end
        if (this.isCorrect(result)) {
          this.endGame(true);
        } else if (this.attempts >= this.config[this.currentMode].maxAttempts) {
          this.endGame(false);
        } else {
          // Clear inputs for next guess
          inputs.forEach(inp => inp.value = '');
          inputs[0].focus();
        }
      }
      
      validateGuess(guess) {
        const length = this.config[this.currentMode].length;
        
        // Check all digits are numbers
        if (guess.length !== length || guess.some(isNaN)) {
          return { valid: false, message: `Please enter all ${length} digits!` };
        }
        
        // First digit cannot be 0
        if (guess[0] === 0) {
          return { valid: false, message: 'First digit cannot be 0!' };
        }
        
        // Check for duplicates
        const set = new Set(guess);
        if (set.size !== length) {
          return { valid: false, message: 'Digits must be unique!' };
        }
        
        // Check range
        if (guess.some(d => d < 0 || d > 9)) {
          return { valid: false, message: 'Only digits 0-9 are allowed!' };
        }
        
        return { valid: true, message: '' };
      }
      
      checkGuess(guess) {
        const result = Array(this.config[this.currentMode].length).fill(0);
        
        for (let i = 0; i < guess.length; i++) {
          if (guess[i] === this.secretNumber[i]) {
            result[i] = 2; // Correct digit and position
          } else if (this.secretNumber.includes(guess[i])) {
            result[i] = 1; // Correct digit, wrong position
          }
        }
        
        return result;
      }
      
      isCorrect(result) {
        return result.every(r => r === 2);
      }
      
      displayHistory() {
        const historyContainer = document.getElementById('history');
        
        this.history.forEach((entry, index) => {
          const historyItem = document.createElement('div');
          historyItem.className = 'history-item';
          historyItem.innerHTML = `
            <div class="guess-numbers">
              ${entry.guess.map(d => `<span>${d}</span>`).join('')}
            </div>
            <div class="guess-feedback">
              ${entry.result.map(res => {
                let iconClass = '';
                let icon = '';
                
                if (res === 2) {
                  iconClass = 'correct';
                  icon = '<i class="fas fa-check"></i>';
                } else if (res === 1) {
                  iconClass = 'partial';
                  icon = '<i class="fas fa-exchange-alt"></i>';
                } else {
                  iconClass = 'wrong';
                  icon = '<i class="fas fa-times"></i>';
                }
                
                return `<span class="feedback-icon ${iconClass}">${icon}</span>`;
              }).join('')}
            </div>
          `;
          
          historyContainer.prepend(historyItem);
        });
      }
      
      giveHint() {
        if (this.hintsLeft === 0 || !this.gameActive) return;
        
        this.hintsLeft--;
        this.updateHintButton();
        
        // Find unrevealed positions
        const unrevealedPositions = [];
        for (let i = 0; i < this.secretNumber.length; i++) {
          if (!this.history.some(entry => entry.result[i] === 2)) {
            unrevealedPositions.push(i);
          }
        }
        
        if (unrevealedPositions.length === 0) return;
        
        // Reveal a random digit
        const randomPos = unrevealedPositions[Math.floor(Math.random() * unrevealedPositions.length)];
        const digit = this.secretNumber[randomPos];
        
        // Show hint
        const hintMessage = `üí° Hint: Digit at position ${randomPos + 1} is ${digit}`;
        document.getElementById('error').textContent = hintMessage;
        document.getElementById('error').style.color = '#ffb142';
        
        // Auto-clear hint after 3 seconds
        setTimeout(() => {
          if (document.getElementById('error').textContent === hintMessage) {
            document.getElementById('error').textContent = '';
          }
        }, 3000);
      }
      
      calculateCurrentGameScore() {
        if (this.history.length === 0) return 0;
        
        const baseScore = 1000;
        const timeBonus = Math.max(0, 300 - Math.floor((Date.now() - this.startTime) / 1000));
        const attemptsBonus = (this.config[this.currentMode].maxAttempts - this.attempts) * 50;
        const multiplier = this.config[this.currentMode].multiplier;
        const hintPenalty = (3 - this.hintsLeft) * 100;
        
        return Math.max(0, (baseScore + timeBonus + attemptsBonus - hintPenalty) * multiplier);
      }
      
      endGame(win) {
        this.gameActive = false;
        this.stopTimer();
        
        const endMessage = document.getElementById('endMessage');
        const playAgainContainer = document.getElementById('playAgain');
        
        if (win) {
          const gameScore = this.calculateCurrentGameScore();
          this.score += gameScore;
          
          if (this.score > this.highScore) {
            this.highScore = this.score;
            this.saveHighScore();
          }
          
          endMessage.innerHTML = `
            <i class="fas fa-trophy"></i>
            <h3>üéâ CONGRATULATIONS!</h3>
            <p>You guessed the number in ${this.attempts} attempts!</p>
            <p>Score: <strong>${gameScore}</strong> points</p>
            <p>Total Score: <strong>${this.score}</strong></p>
          `;
          endMessage.className = 'game-result win';
          endMessage.style.display = 'block';
          
          // Save to leaderboard
          this.saveToLeaderboard(gameScore);
        } else {
          endMessage.innerHTML = `
            <i class="fas fa-skull-crossbones"></i>
            <h3>üíÄ GAME OVER!</h3>
            <p>You ran out of attempts.</p>
            <p>The secret number was: <strong>${this.secretNumber.join(' ')}</strong></p>
            <p>Better luck next time!</p>
          `;
          endMessage.className = 'game-result lose';
          endMessage.style.display = 'block';
        }
        
        playAgainContainer.style.display = 'flex';
        document.getElementById('guessForm').style.display = 'none';
        this.updateStats();
        this.updateLeaderboard();
      }
      
      saveToLeaderboard(score) {
        const leaderboard = this.loadLeaderboard();
        const playerName = prompt('Enter your name for the leaderboard:', 'Player');
        
        if (playerName) {
          const entry = {
            name: playerName.substring(0, 15),
            score: score,
            mode: this.currentMode,
            date: new Date().toISOString(),
            attempts: this.attempts
          };
          
          leaderboard.push(entry);
          
          // Sort by score descending
          leaderboard.sort((a, b) => b.score - a.score);
          
          // Keep only top 10
          if (leaderboard.length > 10) {
            leaderboard.splice(10);
          }
          
          localStorage.setItem('numberGuessLeaderboard', JSON.stringify(leaderboard));
        }
      }
      
      loadLeaderboard() {
        try {
          const data = localStorage.getItem('numberGuessLeaderboard');
          return data ? JSON.parse(data) : [];
        } catch {
          return [];
        }
      }
      
      updateLeaderboard(mode = 'easy') {
        const leaderboard = this.loadLeaderboard();
        const container = document.getElementById('leaderboard');
        
        // Filter by mode and sort
        const filtered = leaderboard
          .filter(entry => entry.mode === mode)
          .sort((a, b) => b.score - a.score)
          .slice(0, 10);
        
        if (filtered.length === 0) {
          container.innerHTML = `
            <div class="empty-leaderboard">
              <i class="fas fa-chart-line"></i>
              <p>No leaderboard records yet</p>
              <small>Win a game to appear here!</small>
            </div>
          `;
          return;
        }
        
        let html = '';
        filtered.forEach((entry, index) => {
          const rankClass = index === 0 ? 'gold' : index === 1 ? 'silver' : index === 2 ? 'bronze' : '';
          const date = new Date(entry.date).toLocaleDateString();
          
          html += `
            <div class="leaderboard-item">
              <div class="leaderboard-rank ${rankClass}">${index + 1}</div>
              <div class="leaderboard-info">
                <div class="leaderboard-name">${entry.name}</div>
                <div class="leaderboard-details">
                  ${date} ‚Ä¢ ${entry.attempts} attempts ‚Ä¢ ${entry.mode}
                </div>
              </div>
              <div class="leaderboard-score">${entry.score}</div>
            </div>
          `;
        });
        
        container.innerHTML = html;
      }
      
      changeLeaderboardTab(tabButton) {
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        tabButton.classList.add('active');
        
        const mode = tabButton.dataset.tab;
        this.updateLeaderboard(mode);
      }
      
      loadHighScore() {
        try {
          const score = localStorage.getItem('numberGuessHighScore');
          return score ? parseInt(score) : 0;
        } catch {
          return 0;
        }
      }
      
      saveHighScore() {
        localStorage.setItem('numberGuessHighScore', this.highScore.toString());
      }
    }
    
    // Initialize game when page loads
    document.addEventListener('DOMContentLoaded', () => {
      window.game = new NumberGuessingGame();
    });
  </script>
</body>
</html>
